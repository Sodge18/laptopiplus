<!DOCTYPE html>
<html lang="sr" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">Laptopi Plus</title>

  <!-- Tailwind + Font + Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          fontFamily: { sans: ['Poppins', 'sans-serif'] },
          colors: {
            primary: "#333333",
            "primary-light": "#555555",
            "background-light": "#ffffff",
            "background-dark": "#1f2937",
          },
          borderRadius: { DEFAULT: "0.75rem", xl: "1.25rem", "2xl": "1.5rem" },
          boxShadow: { 'card': '0 10px 30px -5px rgba(0,0,0,0.1)' }
        }
      }
    }
  </script>

  <style>
    .thumbnail { transition: all 0.3s ease; border: 3px solid transparent; }
    .thumbnail.active { border-color: #333333; transform: scale(1.05); }
    .img-zoom { transition: transform 0.5s ease; }
    .img-zoom:hover { transform: scale(1.03); }
    .spec-item { transition: background 0.3s ease; }
    .spec-item:hover { background: #f8f8f8; }
    @media (prefers-color-scheme: dark) {
      .spec-item:hover { background: #2d3748; }
    }
  </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200">

<!-- HEADER -->
<header class="sticky top-0 z-50 bg-white dark:bg-gray-900 shadow-md">
  <div class="container mx-auto px-6 py-5 flex items-center justify-between">
    <a href="index.html" class="flex items-center gap-3 text-primary font-bold text-xl hover:text-primary-light transition">
      <span class="material-icons text-3xl">arrow_back</span>
      Nazad na prodavnicu
    </a>
    <div class="text-2xl font-bold text-primary">Laptopi Plus</div>
  </div>
</header>

<main class="container mx-auto px-6 py-12 max-w-7xl">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">

    <!-- LEVO: GALERIJA -->
    <div class="space-y-6">
      <!-- Glavna slika -->
      <div class="bg-gray-100 dark:bg-gray-800 rounded-2xl shadow-card overflow-hidden img-zoom">
        <img id="mainImage" src="" alt="Glavna slika" class="w-full h-96 lg:h-full object-contain p-8">
        <div id="tagBadge" class="absolute top-6 right-6 bg-primary text-white px-4 py-2 rounded-full font-bold text-sm shadow-lg">
          NOVO
        </div>
      </div>

      <!-- Thumbnailovi -->
      <div id="thumbnails" class="flex gap-4 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-gray-400">
        <!-- JS generiše -->
      </div>
    </div>

    <!-- DESNO: DETALJI -->
    <div class="space-y-10">
      <!-- Naslov + cena -->
      <div>
        <h1 id="title" class="text-4xl lg:text-5xl font-black text-gray-900 dark:text-white mb-4 leading-tight"></h1>
        <div class="text-5xl font-black text-primary mb-2" id="price"></div>
      </div>

      <!-- Opis -->
      <div class="bg-gray-50 dark:bg-gray-800 rounded-2xl p-8 shadow-card">
        <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-white">Opis proizvoda</h2>
        <p id="description" class="text-lg leading-relaxed text-gray-700 dark:text-gray-300"></p>
      </div>

      <!-- Specifikacije -->
      <div class="bg-gray-50 dark:bg-gray-800 rounded-2xl p-8 shadow-card">
        <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-white">Tehničke specifikacije</h2>
        <div id="specs" class="grid grid-cols-1 sm:grid-cols-2 gap-5 text-lg"></div>
      </div>

      <!-- CTA dugme -->
      <button id="chooseBtn" class="w-full bg-primary hover:bg-primary-light text-white font-black text-2xl py-6 rounded-2xl shadow-card transition-all duration-300 hover:shadow-2xl transform hover:-translate-y-1">
        IZABERI OVAJ LAPTOP I POŠALJI UPIT
      </button>
    </div>
  </div>
</main>

<script>
const API_URL = "https://products-api.sergej-kaldesic.workers.dev/";

async function loadProduct() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get("selected");
  
  if (!id) {
    document.body.innerHTML = `<div class="text-center py-32"><h1 class="text-4xl font-bold text-red-600">Proizvod nije pronađen</h1><a href="index.html" class="text-primary text-xl underline mt-6 inline-block">← Nazad</a></div>`;
    return;
  }

  try {
    const res = await fetch(API_URL);
    const data = await res.json();
    const products = data.products || data;
    const product = products.find(p => p.id === id);

    if (!product) throw new Error("Laptop nije pronađen");

    // SEO + naslov
    document.getElementById("pageTitle").textContent = `${product.title} - Laptopi Plus`;
    document.getElementById("title").textContent = product.title;
    document.getElementById("price").textContent = product.price ? `${product.price}€` : "Cena na upit";
    document.getElementById("description").textContent = product.description || product.shortDesc || "Nema detaljnog opisa.";
    document.getElementById("tagBadge").textContent = product.tag || "Premium";

    // Galerija
    const images = product.images && product.images.length > 0 ? product.images : ["https://via.placeholder.com/800?text=Laptop"];
    document.getElementById("mainImage").src = images[0];

    const thumbsContainer = document.getElementById("thumbnails");
    thumbsContainer.innerHTML = images.map((src, i) => `
      <img src="${src}" alt="Slika ${i+1}" class="w-28 h-28 object-cover rounded-xl cursor-pointer thumbnail shadow-md ${i===0?'active':''}"
           onclick="document.getElementById('mainImage').src='${src}'; document.querySelectorAll('.thumbnail').forEach(t=>t.classList.remove('active')); this.classList.add('active')">
    `).join("");

    // Specifikacije
    const specsContainer = document.getElementById("specs");
    const specKeys = ['CPU','RAM','GPU','Memorija','Ekran','Baterija','OS','Težina','Dimenzije','Portovi','Bežične konekcije','Kamera','Audio'];
    specsContainer.innerHTML = specKeys.map(key => {
      if (!product.specs?.[key]) return '';
      return `
        <div class="spec-item p-5 rounded-xl bg-white dark:bg-gray-700 shadow-sm">
          <div class="font-medium text-gray-600 dark:text-gray-400">${key}</div>
          <div class="font-bold text-xl text-gray-900 dark:text-white mt-1">${product.specs[key]}</div>
        </div>`;
    }).join("");

    // Dugme
    document.getElementById("chooseBtn").onclick = () => {
      window.location.href = `index.html?selected=${product.id}#contact-form-section`;
    };

  } catch (err) {
    console.error(err);
    document.body.innerHTML = `<div class="text-center py-32"><h1 class="text-4xl font-bold text-red-600">Greška pri učitavanju</h1><a href="index.html" class="text-primary text-xl underline mt-6 inline-block">← Nazad</a></div>`;
  }
}

document.addEventListener("DOMContentLoaded", loadProduct);
</script>
</body>
</html>
