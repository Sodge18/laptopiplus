<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">Laptopi Plus</title>

  <!-- Tailwind + Font + Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- FORSIRA LIGHT MODE – 100% SIGURNO -->
  <script>
    document.documentElement.classList.remove('dark');
    localStorage.setItem('theme', 'light'); // sprečava da se ikad aktivira dark
  </script>

  <script>
    tailwind.config = {
      darkMode: "class", // dozvoljava dark mode uopšte, ali ga mi nikad ne aktiviramo
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            primary: "#333333",
          }
        }
      }
    }
  </script>

  <style>
    .thumbnail {
      transition: all 0.3s ease;
      border: 2px solid transparent;
      opacity: 0.8;
    }
    .thumbnail:hover, .thumbnail.active {
      border-color: #333333;
      opacity: 1;
      transform: scale(1.05);
    }
    .main-image {
      transition: transform 0.5s ease;
    }
    .main-image:hover {
      transform: scale(1.02);
    }
  </style>
</head>

<!-- LIGHT MODE JE FORSIRAN NA HTML TAGU -->
<body class="bg-white text-gray-800 min-h-screen">

<!-- HEADER -->
<header class="sticky top-0 z-50 bg-white border-b border-gray-200 shadow-sm">
  <div class="container mx-auto px-6 py-6 flex items-center justify-between">
    <a href="index.html" class="flex items-center gap-3 text-primary font-bold hover:opacity-80 transition">
      <span class="material-icons text-3xl">arrow_back</span>
      Nazad na prodavnicu
    </a>
    <h1 class="text-2xl font-bold">Laptopi Plus</h1>
  </div>
</header>

<main class="container mx-auto px-6 py-12 max-w-7xl">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20">

    <!-- LEVO: GALERIJA -->
    <div class="space-y-6">
      <div class="bg-gray-100 rounded-2xl overflow-hidden shadow-lg main-image">
        <img id="mainImage" src="" alt="Laptop" class="w-full h-full object-contain p-8 lg:p-12">
      </div>

      <div id="thumbnails" class="grid grid-cols-4 gap-4">
        <!-- JS generiše -->
      </div>
    </div>

    <!-- DESNO: SADRŽAJ -->
    <div class="space-y-12">
      <div>
        <h1 id="title" class="text-5xl lg:text-6xl font-black text-gray-900 mb-4"></h1>
        <p id="shortDesc" class="text-xl text-gray-600 mb-8"></p>
        
        <div class="text-5xl font-black text-primary mb-12" id="price"></div>

        <button id="chooseBtn" 
                class="w-full bg-primary text-white font-bold text-xl py-6 rounded-xl hover:bg-gray-800 transition shadow-lg transform hover:scale-105">
          IZABERI OVAJ LAPTOP I POŠALJI UPIT
        </button>
      </div>

      <!-- DETALJAN OPIS -->
      <div>
        <h2 class="text-3xl font-bold mb-8 border-b-2 border-gray-300 pb-4">
          Detaljan opis
        </h2>
        <div id="description" class="prose prose-lg text-gray-700 leading-relaxed"></div>
      </div>

      <!-- SPECIFIKACIJE -->
      <div>
        <h2 class="text-3xl font-bold mb-8 border-b-2 border-gray-300 pb-4">
          Tehničke specifikacije
        </h2>
        <div id="specs" class="space-y-4"></div>
      </div>
    </div>
  </div>
</main>

<script>
const API_URL = "https://products-api.sergej-kaldesic.workers.dev/";

async function loadProduct() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get("selected");

  if (!id) {
    document.body.innerHTML = `<div class="text-center py-32 text-4xl font-bold text-red-600">Proizvod nije pronađen</div>`;
    return;
  }

  try {
    const res = await fetch(API_URL);
    const data = await res.json();
    const products = data.products || data;
    const product = products.find(p => p.id === id);

    if (!product) throw new Error("Not found");

    document.getElementById("pageTitle").textContent = `${product.title} - Laptopi Plus`;
    document.getElementById("title").textContent = product.title;
    document.getElementById("shortDesc").textContent = product.shortDesc || "";
    document.getElementById("price").textContent = product.price ? `${product.price}€` : "Cena na upit";
    document.getElementById("description").innerHTML = product.description || "Nema detaljnog opisa.";

    // Galerija
    const images = product.images?.length ? product.images : ["https://via.placeholder.com/1000?text=Laptop"];
    document.getElementById("mainImage").src = images[0];

    const thumbs = document.getElementById("thumbnails");
    thumbs.innerHTML = images.map((src, i) => `
      <img src="${src}" alt="Slika ${i+1}" 
           class="rounded-xl cursor-pointer thumbnail shadow-md ${i===0?'active':''}"
           onclick="document.getElementById('mainImage').src='${src}'; 
                    document.querySelectorAll('.thumbnail').forEach(t=>t.classList.remove('active')); 
                    this.classList.add('active')">
    `).join("");

    // Specifikacije
    const specsDiv = document.getElementById("specs");
    const keys = ['CPU','RAM','GPU','Memorija','Ekran','Baterija','OS','Težina','Dimenzije','Portovi','Bežične konekcije','Kamera','Audio'];
    
    keys.forEach(key => {
      if (product.specs?.[key]) {
        const div = document.createElement("div");
        div.className = "flex justify-between items-center py-5 border-b border-gray-200 last:border-0";
        div.innerHTML = `
          <span class="text-lg font-medium text-gray-600">${key}</span>
          <span class="text-lg font-bold text-gray-900">${product.specs[key]}</span>
        `;
        specsDiv.appendChild(div);
      }
    });

    document.getElementById("chooseBtn").onclick = () => {
      window.location.href = `index.html?selected=${product.id}#contact-form-section`;
    };

  } catch (err) {
    console.error(err);
    document.body.innerHTML = `<div class="text-center py-32 text-4xl font-bold text-red-600">Greška pri učitavanju</div>`;
  }
}

document.addEventListener("DOMContentLoaded", loadProduct);
</script>
</body>
</html>
